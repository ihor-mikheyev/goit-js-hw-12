{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '44649550-1f14fff39212e3f1a5e911ecf';\nconst apiUrl = 'https://pixabay.com/api/';\nexport const perPage = 15;\nexport let currentPage = 1;\n\nexport async function searchImages(query) {\n  const params = {\n    key: apiKey,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  };\n\n  try {\n    const response = await axios.get(apiUrl, { params });\n    const { hits, totalHits } = response.data;\n    currentPage += 1;\n    return { hits, totalHits };\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n","import { refs } from '../main';\n\nfunction createMarkup({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"item\">\n      <a href=\"${largeImageURL}\" class=\"gallery\">\n      <img class='item-img' src=\"${webformatURL}\" alt=\"${tags}\" />\n      <div class=\"item-info\">\n      <div class=\"item-info__text\">Likes <span>${likes}</span></div>\n      <div class=\"item-info__text\">Views <span>${views}</span></div>\n      <div class=\"item-info__text\">Comments <span>${comments}</span></div>\n      <div class=\"item-info__text\">Downloads <span>${downloads}</span></div>\n      </div>\n      </a>\n      </li>`;\n}\n\nfunction renderImage(array) {\n  const markup = array.map(createMarkup).join('');\n  refs.imgOut.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction clearMarkup(element) {\n  element.innerHTML = ' ';\n}\n\nexport { createMarkup, clearMarkup, renderImage };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport {\n  currentPage,\n  perPage,\n  resetPage,\n  searchImages,\n} from './js/pixabay-api';\nimport { renderImage, clearMarkup } from './js/render-functions';\n\nexport const refs = {\n  form: document.querySelector('.form-request'),\n  imgOut: document.getElementById('img-output'),\n  loader: document.querySelector('.loader'),\n  moreBtn: document.querySelector('.action__button'),\n};\n\nrefs.form.addEventListener('submit', handlerSubmit);\nrefs.moreBtn.addEventListener('click', handlerOnClickMore);\n\nconst instance = new SimpleLightbox('.list a', {\n  captions: true,\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nlet userRequest = null;\n\nasync function handlerSubmit(event) {\n  event.preventDefault();\n  userRequest = event.target.searchQuery.value.trim();\n  if (!userRequest) {\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  try {\n    resetPage();\n    const response = await searchImages(userRequest);\n    clearMarkup(refs.imgOut);\n    renderImage(response.hits);\n    scrollDown();\n    showLoadMoreBtn();\n  } catch (error) {\n    console.error(error);\n  } finally {\n    refs.form.reset();\n    refs.loader.style.display = 'none';\n    instance.refresh();\n  }\n}\n\nasync function handlerOnClickMore() {\n  refs.loader.style.display = 'block';\n  try {\n    const { hits, totalHits } = await searchImages(userRequest);\n    renderImage(hits);\n\n    if (currentPage * perPage >= totalHits) {\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n      hideLoadMoreBtn();\n    }\n    scrollDown();\n  } catch {\n    console.error(error);\n  } finally {\n    refs.loader.style.display = 'none';\n    instance.refresh();\n  }\n}\n\nfunction showLoadMoreBtn() {\n  refs.moreBtn.style.display = 'block';\n}\n\nfunction hideLoadMoreBtn() {\n  refs.moreBtn.style.display = 'none';\n}\n\nfunction scrollDown() {\n  const item = document.querySelector('.list');\n  console.log(item);\n  if (item) {\n    const cardHeight = item.getBoundingClientRect().height;\n    console.log(cardHeight);\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n}\n"],"names":["apiKey","apiUrl","perPage","currentPage","searchImages","query","params","response","axios","hits","totalHits","error","resetPage","createMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","renderImage","array","markup","refs","clearMarkup","element","handlerSubmit","handlerOnClickMore","instance","SimpleLightbox","userRequest","event","iziToast","scrollDown","showLoadMoreBtn","hideLoadMoreBtn","item","cardHeight"],"mappings":"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"}